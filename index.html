<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Achievo - Scholarship Finder</title>

    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Exo+2:wght@300;400;600&display=swap" rel="stylesheet">
    <style>
        /* --- Styles are unchanged from the previous version --- */
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: 'Exo 2', sans-serif;
            background: linear-gradient(135deg, #0a0a0a 0%, #1a0a2e 50%, #0a0a0a 100%);
            color: #e0e0e0; min-height: 100vh;
        }
        .header {
            position: fixed; top: 0; left: 0; right: 0; padding: 1.5rem 2rem;
            background: rgba(10, 10, 10, 0.9); backdrop-filter: blur(10px);
            border-bottom: 2px solid rgba(0, 255, 255, 0.3); z-index: 1000;
            display: flex; justify-content: space-between; align-items: center;
        }
        .logo {
            font-family: 'Orbitron', sans-serif; font-size: 2rem; font-weight: 900;
            background: linear-gradient(45deg, #00ffff, #00ff88);
            -webkit-background-clip: text; -webkit-text-fill-color: transparent;
        }
        .user-info { color: #00ffff; font-weight: 600; display: flex; align-items: center; gap: 1.5rem; }
        .profile-icon { font-size: 1.5rem; cursor: pointer; transition: transform 0.2s; }
        .profile-icon:hover { transform: scale(1.2); }
        .auth-page { display: flex; justify-content: center; align-items: center; min-height: 100vh; padding: 2rem; }
        .auth-box {
            background: rgba(20, 20, 40, 0.8); backdrop-filter: blur(20px);
            border: 2px solid rgba(0, 255, 255, 0.4); border-radius: 20px; padding: 3rem;
            max-width: 500px; width: 100%; box-shadow: 0 8px 32px rgba(0, 255, 255, 0.3);
        }
        .auth-title { font-family: 'Orbitron', sans-serif; font-size: 2.5rem; text-align: center; margin-bottom: 2rem; color: #00ffff; }
        .form-group { margin-bottom: 1.5rem; }
        .form-group label { display: block; margin-bottom: 0.5rem; color: #00ffff; font-weight: 600; }
        .form-group input, .form-group select {
            width: 100%; padding: 1rem; background: rgba(0, 0, 0, 0.5);
            border: 2px solid rgba(0, 255, 255, 0.3); border-radius: 10px; color: #fff; font-size: 1rem;
        }
        .form-group select option { background: #1a0a2e; color: #e0e0e0; }
        .btn {
            width: 100%; padding: 1rem; background: linear-gradient(45deg, #8a2be2, #00ffff);
            border: none; border-radius: 10px; color: #fff; font-size: 1.1rem; font-weight: 700;
            cursor: pointer; transition: all 0.3s; margin-top: 1rem;
        }
        .btn-save { background: linear-gradient(45deg, #00ff88, #00ffff); }
        .btn:hover { transform: translateY(-2px); box-shadow: 0 0 30px rgba(0, 255, 255, 0.7); }
        .switch-text { text-align: center; margin-top: 1.5rem; color: #aaa; }
        .switch-link { color: #00ffff; cursor: pointer; text-decoration: underline; font-weight: 600; }
        .dashboard-page { padding-top: 6rem; padding-bottom: 2rem; }
        .welcome {
            background: linear-gradient(90deg, rgba(138, 43, 226, 0.4), rgba(0, 255, 255, 0.4));
            border: 2px solid rgba(0, 255, 255, 0.5); border-radius: 15px; padding: 2rem;
            margin: 0 2rem 2rem 2rem; text-align: center;
        }
        .welcome h2 { font-family: 'Orbitron', sans-serif; color: #00ffff; margin-bottom: 0.5rem; font-size: 2rem; }
        .stats { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1.5rem; padding: 0 2rem 2rem 2rem; }
        .stat-card {
            background: rgba(20, 20, 40, 0.7); border: 2px solid rgba(0, 255, 255, 0.3);
            border-radius: 15px; padding: 2rem; text-align: center;
        }
        .stat-number { font-family: 'Orbitron', sans-serif; font-size: 3rem; color: #00ffff; font-weight: 900; }
        .stat-label { color: #aaa; margin-top: 0.5rem; }
        .controls {
             padding: 0 2rem 2rem 2rem; display: flex;
             flex-wrap: wrap; gap: 1rem;
             border-bottom: 1px solid rgba(0, 255, 255, 0.2);
             padding-bottom: 2rem; margin-bottom: 2rem;
        }
        .search-box { flex: 1; min-width: 250px; margin-bottom: 1rem;}
        .search-box input {
            width: 100%; padding: 1rem; background: rgba(0, 0, 0, 0.5);
            border: 2px solid rgba(0, 255, 255, 0.3); border-radius: 25px; color: #fff; font-size: 1rem;
        }
        .filter-buttons-container { width: 100%; display: flex; flex-wrap: wrap; gap: 0.8rem; }
        .filter-btn {
            padding: 0.8rem 1.5rem; background: rgba(138, 43, 226, 0.3);
            border: 2px solid rgba(138, 43, 226, 0.5); border-radius: 20px; color: #e0e0e0;
            cursor: pointer; transition: all 0.3s; flex-grow: 1;
        }
        .filter-btn.active {
            background: rgba(0, 255, 255, 0.4); border-color: rgba(0, 255, 255, 0.7);
            color: #fff; box-shadow: 0 0 15px rgba(0, 255, 255, 0.5);
        }
        .scholarships { display: grid; grid-template-columns: repeat(auto-fill, minmax(350px, 1fr)); gap: 2rem; padding: 0 2rem; }
        .card {
            background: rgba(20, 20, 40, 0.7); border: 2px solid rgba(0, 255, 255, 0.3);
            border-radius: 20px; padding: 2rem; transition: all 0.4s;
        }
        .card:hover { transform: translateY(-10px); box-shadow: 0 15px 40px rgba(0, 255, 255, 0.4); }
        .card-title { font-family: 'Orbitron', sans-serif; font-size: 1.4rem; color: #00ffff; margin-bottom: 1rem; }
        .matched-badge {
            background: rgba(0, 255, 136, 0.2); border: 1px solid #00ff88; padding: 0.3rem 0.8rem;
            border-radius: 15px; font-size: 0.85rem; color: #00ff88; display: inline-block; margin-bottom: 1rem;
        }
        .expired-badge {
            background: rgba(255, 0, 102, 0.2); border: 1px solid #ff0066; padding: 0.3rem 0.8rem;
            border-radius: 15px; font-size: 0.85rem; color: #ff0066; display: inline-block; margin-bottom: 1rem;
        }
        .card-info { margin: 0.8rem 0; color: #ccc; }
        .card-info strong { color: #00ff88; }
        .card-actions { display: flex; gap: 1rem; margin-top: 1.5rem; }
        .card-btn:disabled {
            background: rgba(100, 100, 100, 0.2); border-color: rgba(100, 100, 100, 0.4);
            color: #888; cursor: not-allowed;
        }
        .card-btn {
            flex: 1; padding: 0.8rem; background: rgba(0, 255, 255, 0.2);
            border: 2px solid rgba(0, 255, 255, 0.5); border-radius: 10px; color: #00ffff;
            cursor: pointer; font-weight: 600; transition: all 0.3s;
        }
        .apply-btn {
            background: rgba(0, 255, 136, 0.2); border-color: rgba(0, 255, 136, 0.5); color: #00ff88;
        }
        .apply-btn:hover { background: rgba(0, 255, 136, 0.4); color: #fff; }
        .modal {
            display: none; position: fixed; top: 0; left: 0; right: 0; bottom: 0;
            background: rgba(0, 0, 0, 0.9); z-index: 2000; align-items: center; justify-content: center; padding: 2rem;
        }
        .modal-content {
            background: rgba(20, 20, 40, 0.95); border: 2px solid rgba(0, 255, 255, 0.5);
            border-radius: 20px; padding: 2.5rem; max-width: 600px; width: 100%; max-height: 80vh; overflow-y: auto;
        }
        .modal-content.profile-modal-content {
             background: rgba(20, 20, 40, 0.8); backdrop-filter: blur(20px);
            border: 2px solid rgba(0, 255, 255, 0.4); box-shadow: 0 8px 32px rgba(0, 255, 255, 0.3);
        }
        .close-btn { float: right; font-size: 2rem; color: #ff0066; cursor: pointer; line-height: 1; }
        @media (max-width: 768px) {
            .scholarships { grid-template-columns: 1fr; }
            .filter-buttons-container { justify-content: center; }
            .filter-btn { flex-grow: 0; }
        }
    </style>
</head>
<body>
    <div class="header">
        <div class="logo">🎓 Achievo</div>
        <div class="user-info" id="userInfo" style="display:none;">
            <span id="userName"></span>
            <span class="profile-icon" onclick="showProfileModal()">👤</span>
            <span onclick="doLogout()" style="color:#ff0066;cursor:pointer;">Logout</span>
        </div>
    </div>

    <div class="auth-page" id="loginPage">
        <div class="auth-box">
            <h1 class="auth-title">Login</h1>
            <div class="form-group"><label>Email</label><input type="email" id="loginEmail"></div>
            <div class="form-group"><label>Password</label><input type="password" id="loginPassword"></div>
            <button class="btn" onclick="doLogin()">Login</button>
            <div class="switch-text"><span class="switch-link" onclick="doForgotPassword()">Forgot Password?</span></div>
            <div class="switch-text">Don't have an account? <span class="switch-link" onclick="goToSignup()">Sign Up</span></div>
        </div>
    </div>

    <div class="auth-page" id="signupPage" style="display:none;">
        <div class="auth-box">
            <h1 class="auth-title">Sign Up</h1>
            <div class="form-group"><label>Name</label><input type="text" id="signupName"></div>
            <div class="form-group"><label>Grade</label><select id="signupGrade"><option value="">Select</option><option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option><option value="5">5</option><option value="6">6</option><option value="7">7</option><option value="8">8</option><option value="9">9</option><option value="10">10</option><option value="11">11</option><option value="12">12</option></select></div>
            <div class="form-group"><label>Board</label><select id="signupBoard"><option value="">Select</option><option value="CBSE">CBSE</option><option value="State">State</option></select></div>
            <div class="form-group"><label>State</label><input type="text" id="signupState"></div>
            <div class="form-group"><label>Email</label><input type="email" id="signupEmail"></div>
            <div class="form-group"><label>Password</label><input type="password" id="signupPassword"></div>
            <button class="btn" onclick="doSignup()">Create Account</button>
            <div class="switch-text">Already have account? <span class="switch-link" onclick="goToLogin()">Login</span></div>
        </div>
    </div>

    <div class="dashboard-page" id="dashboardPage" style="display:none;">
        <div class="welcome">
            <h2>Welcome, <span id="welcomeName"></span>! 🎉</h2>
            <p>Scholarships matched for your profile</p>
        </div>

        <div class="stats">
            <div class="stat-card"><div class="stat-number" id="totalNum">0</div><div class="stat-label">Total</div></div>
            <div class="stat-card"><div class="stat-number" id="matchedNum">0</div><div class="stat-label">Matched</div></div>
            <div class="stat-card"><div class="stat-number" id="savedNum">0</div><div class="stat-label">Saved</div></div>
        </div>

        <div class="controls">
            <div class="search-box">
                <input type="text" placeholder="🔍 Search..." onkeyup="doSearch(this.value)">
            </div>
            <div class="filter-buttons-container">
                 <button class="filter-btn active" id="filter-all" onclick="showAll()">📋 All</button>
                 <button class="filter-btn" id="filter-matched" onclick="showMatched()">✨ Matched</button>
                 <button class="filter-btn" id="filter-Science" onclick="filterBySubject('Science')">🔬 Science</button>
                 <button class="filter-btn" id="filter-Math" onclick="filterBySubject('Math')">🧮 Math</button>
                 <button class="filter-btn" id="filter-English" onclick="filterBySubject('English')">📚 English</button>
                 <button class="filter-btn" id="filter-General" onclick="filterBySubject('General')">💡 General</button>
            </div>
        </div>

        <div class="scholarships" id="list"></div>
    </div>

    <div class="modal" id="modal">
        <div class="modal-content"><span class="close-btn" onclick="closeModal()">×</span><h2 style="color:#00ffff;font-family:'Orbitron'" id="modalTitle"></h2><div id="modalBody" style="margin-top:1.5rem;"></div></div>
    </div>

    <div class="modal" id="profileModal">
        <div class="modal-content profile-modal-content"><span class="close-btn" onclick="closeProfileModal()">×</span><h1 class="auth-title">Your Profile</h1><div class="form-group"><label>Name</label><input type="text" id="profileName"></div><div class="form-group"><label>Grade</label><select id="profileGrade"><option value="">Select</option><option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option><option value="5">5</option><option value="6">6</option><option value="7">7</option><option value="8">8</option><option value="9">9</option><option value="10">10</option><option value="11">11</option><option value="12">12</option></select></div><div class="form-group"><label>Board</label><select id="profileBoard"><option value="">Select</option><option value="CBSE">CBSE</option><option value="State">State</option></select></div><div class="form-group"><label>State</label><input type="text" id="profileState"></div><div class="form-group"><label>Email</label><input type="email" id="profileEmail" disabled></div><button class="btn btn-save" onclick="doUpdateProfile()">Save Changes</button></div>
    </div>

    <script>
        // --- SUPABASE CONFIG ---
        const SUPABASE_URL = 'https://dizupsskxccdgttrdnub.supabase.co'; // 👈 PASTE YOUR URL HERE
        const SUPABASE_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImRpenVwc3NreGNjZGd0dHJkbnViIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjE2NDA0MTAsImV4cCI6MjA3NzIxNjQxMH0.d2oQ1YYMBA2Z50qyzs7E2niv78lUQIqX6JxR4_numeo';   // 👈 PASTE YOUR 'anon' KEY HERE

        const { createClient } = supabase;
        if (!SUPABASE_URL || SUPABASE_URL === 'YOUR_PROJECT_URL' || !SUPABASE_KEY || SUPABASE_KEY === 'YOUR_ANON_KEY') {
            console
